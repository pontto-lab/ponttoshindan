<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã½ã‚“ã£ã¨IQè¨ºæ–­ - ã½ã‚“ã£ã¨ãƒ©ãƒœ</title>
    <style>
        body { font-family: 'ãƒ’ãƒ©ã‚®ãƒä¸¸ã‚´ Pro','Arial Rounded MT Bold',sans-serif; background: #fff; text-align: center; margin: 0; padding: 20px; }
        .container { max-width: 480px; margin: 0 auto; }
        .button { display: inline-block; margin: 10px; padding: 15px; border-radius: 20px; background: #d8bfe6; color: #333; text-decoration: none; font-size: 18px; border: none; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .button:active { transform: scale(0.95); }
        .ad-box { background: #fff0f5; padding: 30px; border: 3px dashed #ffb6c1; margin: 20px 0; border-radius: 20px; }
        img { max-width: 100%; height: auto; }
        #question-number { font-weight: bold; color: #ff69b2; font-size: 1.2rem; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  ã½ã‚“ã£ã¨IQè¨ºæ–­</h1>
        
        <div id="game-screen">
            <p id="question-number">ç¬¬ 1 å• / 5</p>
            <div id="quiz-area"></div>
        </div>

        <div id="ad-screen" style="display: none;">
            <h2 style="color: #ff1493;">æ¡ç‚¹ãŒçµ‚ã‚ã£ãŸã‚ˆï¼âœ¨</h2>
            <div class="ad-box">
                <p style="font-size: 14px; color: #999;">ã€PRã€‘çµæœã‚’è¦‹ã‚‹æº–å‚™ã¯ã„ã„ï¼Ÿ</p>
                <button class="button" onclick="showFinalResult()" style="font-size: 20px; padding: 15px 30px;">
                    ğŸ’“ çµæœã‚’è¦‹ã‚‹ ğŸ’“
                </button>
            </div>
        </div>

        <div id="result-screen" style="display: none;">
            <h2 style="color: #ff1493;">è¨ºæ–­çµæœç™ºè¡¨ï¼</h2>
            <div id="iq-display" style="font-size: 44px; font-weight: bold; margin: 20px 0; background: white; padding: 30px; border-radius: 20px; border: 5px solid #ffb6c1;"></div>
            <p id="iq-comment" style="font-size: 20px; color: #555; line-height: 1.6; white-space: pre-wrap;"></p>
            <br>
            <a href="index.html" class="button">ãƒ›ãƒ¼ãƒ ã¸æˆ»ã‚‹</a>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let score = 0;
        let speedBonus = 0; // ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒœãƒ¼ãƒŠã‚¹ç”¨
        let startTime; // æ™‚é–“è¨ˆæ¸¬ç”¨
        const totalQuestions = 5; 

        const questions = {
            1: { img: "question1.png", choices: [{img:"choice-a.png", ok:false}, {img:"choice-b.png", ok:true}, {img:"choice-c.png", ok:false}] },
            2: { img: "question2.png", choices: [{img:"choice-d.png", ok:false}, {img:"choice-f.png", ok:true}, {img:"choice-e.png", ok:false}] },
            3: { img: "question3.png", choices: [{img:"choice-g.png", ok:true}, {img:"choice-h.png", ok:false}, {img:"choice-i.png", ok:false}] },
            4: {
                img: "question4.png", 
                choices: [
                    { img: "choice-k.png", ok: false }, 
                    { img: "choice-l.png", ok: false }, 
                    { img: "choice-j.png", ok: true }
                ]
            },
            5: {
                img: "question5.png", 
                choices: [
                    { img: "choice-m.png", ok: true },
                    { img: "choice-n.png", ok: false },
                    { img: "choice-o.png", ok: false }
                ]
            }
        };

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const r = Math.floor(Math.random() * (i + 1));
                [array[i], array[r]] = [array[r], array[i]];
            }
            return array;
        }

        function showQuestion() {
            const q = questions[currentStep];
            if (!q || currentStep > totalQuestions) { showAd(); return; }

            document.getElementById('question-number').innerText = `ç¬¬ ${currentStep} å• / ${totalQuestions}`;

            const shuffledChoices = shuffle([...q.choices]);

            let html = `<img src="${q.img}" style="width: 100%; max-width: 400px; border-radius: 15px; margin-bottom: 25px; border: 3px solid #eee;">`;
            html += `<div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">`;
            
            shuffledChoices.forEach(c => {
                html += `
                    <button onclick="nextQuestion(${c.ok})" class="button" style="padding: 10px; background: white; border: 2px solid #ffb6c1;">
                        <img src="${c.img}" width="90" style="display: block;">
                    </button>`;
            });
            html += `</div>`;
            document.getElementById('quiz-area').innerHTML = html;
            
            // å•é¡ŒãŒè¡¨ç¤ºã•ã‚ŒãŸæ™‚é–“ã‚’è¨˜éŒ²
            startTime = Date.now();
        }

        function nextQuestion(isCorrect) {
            if (isCorrect) { 
                score++; 
                // æ­£è§£ã‹ã¤5ç§’ä»¥å†…ãªã‚‰ãƒœãƒ¼ãƒŠã‚¹åŠ ç‚¹
                const timeTaken = (Date.now() - startTime) / 1000;
                if (timeTaken <= 5) {
                    speedBonus += 2; // 1å•ã«ã¤ãæœ€å¤§2ç‚¹ãƒ—ãƒ©ã‚¹
                }
            }
            currentStep++;
            setTimeout(() => { showQuestion(); }, 300);
        }

        function showAd() {
            document.getElementById('game-screen').style.display = "none";
            document.getElementById('ad-screen').style.display = "block";
        }

        function showFinalResult() {
            document.getElementById('ad-screen').style.display = "none";
            document.getElementById('result-screen').style.display = "block";
            const iqDisp = document.getElementById('iq-display');
            const iqComm = document.getElementById('iq-comment');
            
            // åŸºæœ¬IQ ï¼‹ ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒœãƒ¼ãƒŠã‚¹
            let finalIQ = 70 + (score * 12) + speedBonus;
            
            // å…¨å•æ­£è§£ã‹ã¤è¶…é€Ÿã„å ´åˆã®ã¿140ã«å±Šãã‚ˆã†ã«èª¿æ•´
            if (score === 5 && speedBonus >= 8) finalIQ = 140;
            if (finalIQ > 140) finalIQ = 140; // ä¸Šé™140

            iqDisp.innerText = "IQ " + finalIQ;

            if (finalIQ >= 130) { 
                iqComm.innerText = "è¶…å¤©æ‰ï¼âœ¨\nåˆ¤æ–­ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚‚ç¥ãƒ¬ãƒ™ãƒ«ï¼\nç¾ä»£ã®ã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³ã¯å›ã ã­ğŸ’“"; 
            }
            else if (finalIQ >= 115) { 
                iqComm.innerText = "å¤©æ‰ç´šï¼ğŸ‘€\nå›è»¢ã®é€Ÿã•ãŒãƒãƒ³ãƒ‘ãªã„ï¼\né«˜ã„è¦³å¯ŸåŠ›ã¨æ±ºæ–­åŠ›ã‚’æŒã£ã¦ã‚‹ã­ï¼"; 
            }
            else if (finalIQ >= 100) { 
                iqComm.innerText = "å„ªç§€ï¼ğŸ’ª\nã²ã‚‰ã‚ãåŠ›ãŒé‹­ã„ã­ï¼\nè‡ªä¿¡ã‚’æŒã£ã¦ã„ã„ã‚ˆâœ¨"; 
            }
            else if (finalIQ >= 85) { 
                iqComm.innerText = "æ¨™æº–ãƒ¬ãƒ™ãƒ«ï¼ğŸ˜Š\nã˜ã£ãã‚Šè€ƒãˆã‚‹ã‚¿ã‚¤ãƒ—ã‹ãªï¼Ÿ\nå›ã®ä¸å¯§ãªã¨ã“ã‚ã€ç´ æ•µã ã‚ˆğŸ’“"; 
            }
            else { 
                iqDisp.innerText = "IQ 80"; // æœ€ä½ä¿è¨¼
                iqComm.innerText = "ä¼¸ã³ã—ã‚ãŸã£ã·ã‚Šï¼ğŸŒ±\nä»Šæ—¥ã¯è„³ãŒãŠç–²ã‚Œã‹ã‚‚ï¼Ÿ\nã‚†ã£ãã‚Šä¼‘ã‚“ã§ã¾ãŸæŒ‘æˆ¦ã—ã¦ã­ï¼"; 
            }
        }

        showQuestion();
    </script>
</body>
</html>
